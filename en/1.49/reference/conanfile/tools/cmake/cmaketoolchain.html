



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CMakeToolchain &mdash; conan 1.49.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/conan-favicon.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  


  
    <link rel="stylesheet" href="../../../../_static/css/signup.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../../../_static/css/search.css" type="text/css" />
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="conan 1.49.0 documentation" href="../../../../index.html"/>
        <link rel="up" title="conan.tools.cmake" href="../cmake.html"/>
        <link rel="next" title="CMake" href="cmake.html"/>
        <link rel="prev" title="CMakeDeps" href="cmakedeps.html"/>

 <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
 



</script>


  

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://conan.io">
          

          
            
            <img src="../../../../_static/conan-logo.png" class="logo" />
          
          </a>

            

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cheatsheet.html">Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../training_courses.html">Training Courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../using_packages.html">Using packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../creating_packages.html">Creating Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../uploading_packages.html">Uploading Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developing_packages.html">Developing packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mastering.html">Mastering Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../extending.html">Extending Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../howtos.html">Howtos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../commands.html">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../conanfile.html">conanfile.py</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../attributes.html">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../methods.html">Methods</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../tools.html">tools</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../cmake.html">conan.tools.cmake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gnu.html">conan.tools.gnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../google.html">conan.tools.google</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apple.html">conan.tools.apple</a></li>
<li class="toctree-l4"><a class="reference internal" href="../meson.html">conan.tools.meson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../intel.html">conan.tools.intel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../microsoft.html">conan.tools.microsoft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../qbs.html">conan.tools.qbs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../env.html">conan.tools.env</a></li>
<li class="toctree-l4"><a class="reference internal" href="../system.html">conan.tools.system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../files.html">conan.tools.files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../layout.html">conan.tools.layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scm.html">conan.tools.scm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../build.html">conan.tools.build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dependencies.html">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../other.html">Python requires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../other.html#output-and-running">Output and Running</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../generators.html">Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../profiles.html">Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../build_helpers.html">Build helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../env_vars.html">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hooks.html">Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../conan_v2_mode.html">CONAN_V2_MODE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../conan_v2.html">Conan migration guide to 2.0</a></li>
</ul>

            
          
          <div class="dark_newsletter-div">
             <p>Sign up for release updates:</p>
              <script src="https://app-lon04.marketo.com/js/forms2/js/forms2.min.js"></script>
              <form id="mktoForm_1479"></form>
              <script>MktoForms2.loadForm("https://app-lon04.marketo.com", "256-FNZ-187", 1479);</script>
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">conan</a>
        
      </nav>


      
      <script>
        var reldir = "../../../../index.html".replace("index.html","").replace("#", "");
      </script>
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation" id="breadcrumbs">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../reference.html">Reference</a> &raquo;</li>
        
          <li><a href="../../../conanfile.html">conanfile.py</a> &raquo;</li>
        
          <li><a href="../../tools.html">tools</a> &raquo;</li>
        
          <li><a href="../cmake.html">conan.tools.cmake</a> &raquo;</li>
        
      <li>CMakeToolchain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/conan-io/docs/blob/master/reference/conanfile/tools/cmake/cmaketoolchain.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
          <!--<select id="search" name="state" multiple="true" onchange="window.location = reldir + this.value;" style="width:90%"></select>
          <hr/>-->
          <!--<div class="admonition important">
            <p class="admonition-title">Announcement</p>
            <p>Conan 2.0 Livestream and Workshop! Join us and get hands on experience upgrading recipes. <a
            href=https://blog.conan.io/2022/10/12/cooking-with-conan-cci-v2-livestream.html> Please refer this blog post for more detail.</a>
          </div>-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cmaketoolchain">
<span id="conan-cmake-toolchain"></span><h1>CMakeToolchain<a class="headerlink" href="#cmaketoolchain" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">These tools are still <strong>experimental</strong> (so subject to breaking changes) but with very stable syntax.
We encourage the usage of it to be prepared for Conan 2.0.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> is the toolchain generator for CMake. It will generate toolchain files that can be used in the
command line invocation of CMake with the <code class="docutils literal notranslate"><span class="pre">-DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake</span></code>. This generator translates
the current package configuration, settings, and options, into CMake toolchain syntax.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This class will require very soon to define both the “host” and “build” profiles. It is very recommended to
start defining both profiles immediately to avoid future breaking. Furthermore, some features, like trying to
cross-compile might not work at all if the “build” profile is not provided.</p>
</div>
<p>It can be declared as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span>

<span class="k">class</span> <span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeToolchain&quot;</span>
</pre></div>
</div>
<p>Or fully instantiated in the <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="s2">&quot;hello/0.1&quot;</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeDeps&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
    <span class="n">default_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;MYVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYVAR_VALUE&quot;</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="p">[</span><span class="s2">&quot;MYDEFINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYDEF_VALUE&quot;</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>This will generate the following files after a <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> (or when building the package
in the cache) with the information provided in the <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method as well as information
translated from the current <code class="docutils literal notranslate"><span class="pre">settings</span></code>:</p>
<ul>
<li><p class="first"><em>conan_toolchain.cmake</em> file, containing the translation of Conan settings to CMake variables.
Some things that will be defined in this file:</p>
<ul class="simple">
<li>Definition of the CMake generator platform and generator toolset</li>
<li>Definition of the <code class="docutils literal notranslate"><span class="pre">CMAKE_POSITION_INDEPENDENT_CODE</span></code>, based on <code class="docutils literal notranslate"><span class="pre">fPIC</span></code> option.</li>
<li>Definition of the C++ standard as necessary</li>
<li>Definition of the standard library used for C++</li>
<li>Deactivation of rpaths in OSX</li>
</ul>
</li>
<li><p class="first"><em>CMakePresets.json</em>: The toolchain also generates a <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> standard file, check the documentation
<a class="reference external" href="https://cmake.org/cmake/help/latest/manual/cmake-presets.7.html">here</a>. It is currently using the version “3” of
the JSON schema.
Conan creates a <code class="docutils literal notranslate"><span class="pre">default</span></code> configure preset with the information:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">generator</span></code> to be used.</li>
<li>The path to the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code></li>
<li>Some cache variables corresponding to the specified settings cannot work if specified in the toolchain.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> variable when using a single-configuration generators.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><em>CMakeUserPresets.json</em>:  If you declare a <code class="docutils literal notranslate"><span class="pre">layout()</span></code> in the recipe and your <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file is found at
the <code class="docutils literal notranslate"><span class="pre">conanfile.source_folder</span></code> folder, a <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> file will be generated (if doesn’t exist already) including
automatically the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> (at the <code class="docutils literal notranslate"><span class="pre">conanfile.generators_folder</span></code>) to allow your IDE (Visual Studio,
Visual Studio Code, CLion…) or <code class="docutils literal notranslate"><span class="pre">cmake</span></code> tool to locate the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code>. The version schema of the generated
<code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> is “4” and requires CMake &gt;= 3.23.</p>
</li>
<li><p class="first"><em>conanvcvars.bat</em>: In some cases, the Visual Studio environment needs to be defined correctly for building,
like when using the Ninja or NMake generators. If necessary, the <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> will generate this script,
so defining the correct Visual Studio prompt is easier.</p>
</li>
</ul>
<div class="section" id="constructor">
<h2>constructor<a class="headerlink" href="#constructor" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conanfile</span><span class="p">):</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">conanfile</span></code>: the current recipe object. Always use <code class="docutils literal notranslate"><span class="pre">self</span></code>.</li>
</ul>
</div>
<div class="section" id="preprocessor-definitions">
<h2>preprocessor_definitions<a class="headerlink" href="#preprocessor-definitions" title="Permalink to this headline">¶</a></h2>
<p>This attribute allows defining compiler preprocessor definitions, for multiple configurations (Debug, Release, etc).</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="p">[</span><span class="s2">&quot;MYDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="s2">&quot;MYCONFIGDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyDebugValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="o">.</span><span class="n">release</span><span class="p">[</span><span class="s2">&quot;MYCONFIGDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyReleaseValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>This will be translated to:</p>
<ul class="simple">
<li>One <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code> definition for <code class="docutils literal notranslate"><span class="pre">MYDEF</span></code> in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li>One <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code> definition, using a cmake generator expression in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file,
using the different values for different configurations.</li>
</ul>
</div>
<div class="section" id="variables">
<h2>variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<p>This attribute allows defining CMake variables, for multiple configurations (Debug, Release, etc).</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;MYVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="s2">&quot;MYCONFIGVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyDebugValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">release</span><span class="p">[</span><span class="s2">&quot;MYCONFIGVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyReleaseValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>This will be translated to:</p>
<ul class="simple">
<li>One <code class="docutils literal notranslate"><span class="pre">set()</span></code> definition for <code class="docutils literal notranslate"><span class="pre">MYVAR</span></code> in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li>One <code class="docutils literal notranslate"><span class="pre">set()</span></code> definition, using a cmake generator expression in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file,
using the different values for different configurations.</li>
</ul>
<p>The booleans assigned to a variable will be translated to <code class="docutils literal notranslate"><span class="pre">ON</span></code> and <code class="docutils literal notranslate"><span class="pre">OFF</span></code> symbols in CMake:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;FOO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;VAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>Will generate the sentences: <code class="docutils literal notranslate"><span class="pre">set(FOO</span> <span class="pre">ON</span> <span class="pre">...)</span></code> and <code class="docutils literal notranslate"><span class="pre">set(VAR</span> <span class="pre">OFF</span> <span class="pre">...)</span></code>.</p>
</div>
<div class="section" id="generators">
<h2>Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> is intended to run with the <code class="docutils literal notranslate"><span class="pre">CMakeDeps</span></code> dependencies generator. Please do not use other
CMake legacy generators (like <code class="docutils literal notranslate"><span class="pre">cmake</span></code>, or <code class="docutils literal notranslate"><span class="pre">cmake_paths</span></code>) with it.</p>
</div>
<div class="section" id="using-a-custom-toolchain-file">
<h2>Using a custom toolchain file<a class="headerlink" href="#using-a-custom-toolchain-file" title="Permalink to this headline">¶</a></h2>
<p>There are two ways of providing custom CMake toolchain files:</p>
<ul>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file can be completely skipped and replaced by a user one, defining the
<code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:toolchain_file=&lt;filepath&gt;</span></code> configuration value.</p>
</li>
<li><p class="first">A custom user toolchain file can be added (included from) to the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> one, by using the
<code class="docutils literal notranslate"><span class="pre">user_toolchain</span></code> block described below, and defining the <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;&lt;filepath&gt;&quot;]</span></code>
configuration value.</p>
<p>The configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;&lt;filepath&gt;&quot;]</span></code> can be defined in the <a class="reference internal" href="../../../config_files/global_conf.html#global-conf"><span class="std std-ref">global.conf</span></a>
but also creating a Conan package for your toolchain and using <code class="docutils literal notranslate"><span class="pre">self.conf_info</span></code> to declare the toolchain file:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="k">class</span> <span class="nc">MyToolchainPackage</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">package_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_folder</span><span class="p">,</span> <span class="s2">&quot;mytoolchain.cmake&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf_info</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="s2">&quot;tools.cmake.cmaketoolchain:user_toolchain&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
<p>If you declare the previous package as a <code class="docutils literal notranslate"><span class="pre">tool_require</span></code>, the toolchain will be automatically applied.</p>
</li>
<li><p class="first">If you have more than one <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code> defined, you can easily append all the user toolchain values
together using the <code class="docutils literal notranslate"><span class="pre">append</span></code> method in each of them, for instance:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="k">class</span> <span class="nc">MyToolRequire</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">package_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_folder</span><span class="p">,</span> <span class="s2">&quot;mytoolchain.cmake&quot;</span><span class="p">)</span>
        <span class="c1"># Appending the value to any existing one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tools.cmake.cmaketoolchain:user_toolchain&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>So, they’ll be automatically applied by your <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> generator without writing any extra code:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMake</span>
<span class="k">class</span> <span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">exports_sources</span> <span class="o">=</span> <span class="s2">&quot;CMakeLists.txt&quot;</span>
    <span class="n">tool_requires</span> <span class="o">=</span> <span class="s2">&quot;toolchain1/0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;toolchain2/0.1&quot;</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeToolchain&quot;</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cmake</span> <span class="o">=</span> <span class="n">CMake</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cmake</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="using-the-toolchain-in-developer-flow">
<h2>Using the toolchain in developer flow<a class="headerlink" href="#using-the-toolchain-in-developer-flow" title="Permalink to this headline">¶</a></h2>
<p>One of the advantages of using Conan toolchains is that they can help to achieve the exact same build
with local development flows, than when the package is created in the cache.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span># Lets start in the folder containing the conanfile.py
$ mkdir build &amp;&amp; cd build
# Install both debug and release deps and create the toolchain
$ conan install ..
$ conan install .. -s build_type=Debug
# the conan_toolchain.cmake is common for both configurations
</pre></div>
</div>
<p>If you are using a multi-configuration generator:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span># Need to pass the generator WITHOUT the platform, that matches your default settings
$ cmake .. -G &quot;Visual Studio 15&quot; -DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake
# Now you can open the IDE, select Debug or Release config and build
# or, in the command line
$ cmake --build . --config Release
$ cmake --build . --config Debug
</pre></div>
</div>
<p><strong>NOTE</strong>: The platform (Win64), is already encoded in the toolchain. The command line shouldn’t pass it, so using
<code class="docutils literal notranslate"><span class="pre">-G</span> <span class="pre">&quot;Visual</span> <span class="pre">Studio</span> <span class="pre">15&quot;</span></code> instead of the <code class="docutils literal notranslate"><span class="pre">-G</span> <span class="pre">&quot;Visual</span> <span class="pre">Studio</span> <span class="pre">15</span> <span class="pre">Win64&quot;</span></code></p>
<p>If you are using a single-configuration generator:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>$ cmake ..  -DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake -DCMAKE_BUILD_TYPE=Release
$ cmake --build
</pre></div>
</div>
<p>It is recommended to use the <code class="docutils literal notranslate"><span class="pre">cmake_layout(self)</span></code> in the <code class="docutils literal notranslate"><span class="pre">layout()</span></code> method of your <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code>. If a layout
is declared, the <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> file will be generated in the same folder of your <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file,
so you can use the <code class="docutils literal notranslate"><span class="pre">--preset</span></code> argument from <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">&gt;=</span> <span class="pre">3.23</span></code> or use an IDE:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span># The conan_toolchain.cmake is common for both configurations and will be located at &quot;build/generators&quot;
$ conan install .
$ conan install . -s build_type=Debug

# For single-configuration generator
$ cmake --preset Debug
$ cmake --build --preset Debug
$ cmake --preset Release
$ cmake --build --preset Release

# For multi-configuration generator
$ cmake --preset default
$ cmake --build --preset Debug
$ cmake --build --preset Release
</pre></div>
</div>
</div>
<div class="section" id="conf">
<h2>conf<a class="headerlink" href="#conf" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> is affected by these <a class="reference internal" href="../../../config_files/global_conf.html#global-conf"><span class="std std-ref">[conf]</span></a> variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:toolchain_file</span></code> user toolchain file to replace the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> one.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain</span></code> list of user toolchains to be included from the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.android:ndk_path</span></code> value for <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_name</span></code> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_version</span></code> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_processor</span></code> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:toolset_arch</span></code>: Will add the <code class="docutils literal notranslate"><span class="pre">,host=xxx</span></code> specifier in the <code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_TOOLSET</span></code> variable of <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:cxxflags</span></code> list of extra C++ flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_FLAGS_INIT</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:cflags</span></code> list of extra of pure C flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_C_FLAGS_INIT</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:sharedlinkflags</span></code> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_SHARED_LINKER_FLAGS_INIT</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:exelinkflags</span></code> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_EXE_LINKER_FLAGS_INIT</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:defines</span></code> list of preprocessor definitions that will be used by <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:tools.apple:enable_bitcode</span></code> boolean value to enable/disable Bitcode Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_ENABLE_BITCODE</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:tools.apple:enable_arc</span></code> boolean value to enable/disable ARC Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:tools.apple:enable_visibility</span></code> boolean value to enable/disable Visibility Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_GCC_SYMBOLS_PRIVATE_EXTERN</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tools.build:sysroot</span></code> defines the value of <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSROOT</span></code>.</li>
</ul>
</div>
<div class="section" id="extending-and-customizing-cmaketoolchain">
<h2>Extending and customizing CMakeToolchain<a class="headerlink" href="#extending-and-customizing-cmaketoolchain" title="Permalink to this headline">¶</a></h2>
<p>Since Conan 1.36, <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> implements a powerful capability for extending and customizing the resulting toolchain file.</p>
<p>The following predefined blocks are available, and added in this order:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">user_toolchain</span></code>: Allows to include user toolchains from the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.
If the configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;xxxx&quot;,</span> <span class="pre">&quot;yyyy&quot;]</span></code> is defined, its values will be <code class="docutils literal notranslate"><span class="pre">include(xxx)\ninclude(yyyy)</span></code> as the
first lines in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">generic_system</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>,
<code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_PLATFORM</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_TOOLSET</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_C_COMPILER</span></code>,
<code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">android_system</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">ANDROID_PLATFORM</span></code>, <code class="docutils literal notranslate"><span class="pre">ANDROID_STL</span></code>, <code class="docutils literal notranslate"><span class="pre">ANDROID_ABI</span></code> and includes <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH/build/cmake/android.toolchain.cmake</span></code>
where <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH</span></code> comes defined in <code class="docutils literal notranslate"><span class="pre">tools.android:ndk_path</span></code> configuration value.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">apple_system</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_OSX_ARCHITECTURES</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_OSX_SYSROOT</span></code> for Apple systems.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fpic</span></code>: Defines the <code class="docutils literal notranslate"><span class="pre">CMAKE_POSITION_INDEPENDENT_CODE</span></code> when there is a <code class="docutils literal notranslate"><span class="pre">options.fPIC</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">arch_flags</span></code>: Defines C/C++ flags like <code class="docutils literal notranslate"><span class="pre">-m32,</span> <span class="pre">-m64</span></code> when necessary.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">libcxx</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">-stdlib=libc++</span></code> flag when necessary as well as <code class="docutils literal notranslate"><span class="pre">_GLIBCXX_USE_CXX11_ABI</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">vs_runtime</span></code>: Defines the <code class="docutils literal notranslate"><span class="pre">CMAKE_MSVC_RUNTIME_LIBRARY</span></code> variable, as a generator expression for multiple configurations.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">cppstd</span></code>: defines <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_STANDARD</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_EXTENSIONS</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">parallel</span></code>: defines <code class="docutils literal notranslate"><span class="pre">/MP</span></code> parallel build flag for Visual.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">cmake_flags_init</span></code>: defines <code class="docutils literal notranslate"><span class="pre">CMAKE_XXX_FLAGS</span></code> variables based on previously defined Conan variables. The blocks above only define <code class="docutils literal notranslate"><span class="pre">CONAN_XXX</span></code> variables, and this block will define CMake ones like <code class="docutils literal notranslate"><span class="pre">set(CMAKE_CXX_FLAGS_INIT</span> <span class="pre">&quot;${CONAN_CXX_FLAGS}&quot;</span> <span class="pre">CACHE</span> <span class="pre">STRING</span> <span class="pre">&quot;&quot;</span> <span class="pre">FORCE)`</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">try_compile</span></code>: Stop processing the toolchain, skipping the blocks below this one, if <code class="docutils literal notranslate"><span class="pre">IN_TRY_COMPILE</span></code> CMake property is defined.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">find_paths</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_FIND_PACKAGE_PREFER_CONFIG</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_MODULE_PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_PREFIX_PATH</span></code> so the generated files from <code class="docutils literal notranslate"><span class="pre">CMakeDeps</span></code> are found.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">rpath</span></code>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_SKIP_RPATH</span></code>. By default it is disabled, and it is needed to define <code class="docutils literal notranslate"><span class="pre">self.blocks[&quot;rpath&quot;].skip_rpath=True</span></code> if you want to activate <code class="docutils literal notranslate"><span class="pre">CMAKE_SKIP_RPATH</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">shared</span></code>: defines <code class="docutils literal notranslate"><span class="pre">BUILD_SHARED_LIBS</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">output_dirs</span></code>: Define the <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_XXX</span></code> variables.</p>
<blockquote>
<div><ul class="simple">
<li><strong>CMAKE_INSTALL_PREFIX</strong>: Is set with the <code class="docutils literal notranslate"><span class="pre">package_folder</span></code>, so if a “cmake install” operation is run, the artifacts go
to that location.</li>
<li><strong>CMAKE_INSTALL_BINDIR</strong>, <strong>CMAKE_INSTALL_SBINDIR</strong> and <strong>CMAKE_INSTALL_LIBEXECDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">bin</span></code>.</li>
<li><strong>CMAKE_INSTALL_LIBDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">lib</span></code>.</li>
<li><strong>CMAKE_INSTALL_INCLUDEDIR</strong> and <strong>CMAKE_INSTALL_OLDINCLUDEDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">include</span></code>.</li>
<li><strong>CMAKE_INSTALL_DATAROOTDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">res</span></code>.</li>
</ul>
<p>If you want to change the default values, adjust the <code class="docutils literal notranslate"><span class="pre">cpp.package</span></code> object at the <code class="docutils literal notranslate"><span class="pre">layout()</span></code> method:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="c1"># For CMAKE_INSTALL_BINDIR, CMAKE_INSTALL_SBINDIR and CMAKE_INSTALL_LIBEXECDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">bindirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mybin&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_LIBDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">libdirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mylib&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_INCLUDEDIR, CMAKE_INSTALL_OLDINCLUDEDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">includedirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;myinclude&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_DATAROOTDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">resdirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;myres&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is <strong>not valid</strong> to change the self.cpp_info  at the <code class="docutils literal notranslate"><span class="pre">package_info()</span></code> method.</p>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Conan 1.45 the CMakeToolchain doesn’t append the root package folder of the dependencies (declared in the cpp_info.builddirs)
to the <code class="docutils literal notranslate"><span class="pre">CMAKE_PREFIX_PATH</span></code> variable. That interfered with the <code class="docutils literal notranslate"><span class="pre">find_file</span></code>, <code class="docutils literal notranslate"><span class="pre">find_path</span></code> and <code class="docutils literal notranslate"><span class="pre">find_program</span></code>, making,
for example, impossible to locate only the executables from the build context. In Conan 2.0, the <code class="docutils literal notranslate"><span class="pre">cppinfo.builddirs</span></code>
won’t contain by default the <code class="docutils literal notranslate"><span class="pre">''</span></code> entry (root package).</p>
</div>
<p>Blocks can be customized in different ways:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove an existing block</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;generic_system&quot;</span><span class="p">)</span>

<span class="c1"># modify the template of an existing block</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">template</span>
    <span class="n">new_tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># replace, fully replace, append...</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">new_tmp</span>

<span class="c1"># modify one or more variables of the context</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="n">conanfile</span><span class="p">)</span>
    <span class="c1"># block.values is the context dictionary</span>
    <span class="n">toolset</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;toolset&quot;</span><span class="p">]</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;toolset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;other_toolset&quot;</span>

<span class="c1"># modify the whole context values</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="n">conanfile</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;toolset&quot;</span><span class="p">:</span> <span class="s2">&quot;other_toolset&quot;</span><span class="p">}</span>

<span class="c1"># modify the context method of an existing block</span>
<span class="kn">import</span> <span class="nn">types</span>

<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">generic_block</span> <span class="o">=</span> <span class="n">toolchain</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span>  <span class="c1"># Your own custom logic here</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;toolset&quot;</span><span class="p">:</span> <span class="s2">&quot;other_toolset&quot;</span><span class="p">}</span>
    <span class="n">generic_block</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">generic_block</span><span class="p">)</span>

<span class="c1"># completely replace existing block</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>

<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># this could go to a python_requires</span>
    <span class="k">class</span> <span class="nc">MyGenericBlock</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;HelloWorld&quot;</span>

        <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{}</span>

    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MyGenericBlock</span>

<span class="c1"># add a completely new block</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># this could go to a python_requires</span>
    <span class="k">class</span> <span class="nc">MyBlock</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;Hello {{myvar}}!!!&quot;</span>

        <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;myvar&quot;</span><span class="p">:</span> <span class="s2">&quot;World&quot;</span><span class="p">}</span>

    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;mynewblock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MyBlock</span>
</pre></div>
</div>
<p>Recall that this is a very <strong>experimental</strong> feature, and these interfaces might change in the following releases.</p>
<p>For more information about these blocks, please have a look at the source code.</p>
</div>
<div class="section" id="cross-building">
<h2>Cross building<a class="headerlink" href="#cross-building" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">generic_system</span></code> block contains some basic cross-building capabilities. In the general
case, the user would want to provide their own user toolchain defining all the specifics,
which can be done with the configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain</span></code>. If
this conf value is defined, the <code class="docutils literal notranslate"><span class="pre">generic_system</span></code> block will include the provided file or files, but
no further define any CMake variable for cross-building.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">user_toolchain</span></code> is not defined and Conan detects it is cross-building, because the build
and host profiles contain different OS or architecture, it will try to define the following
variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_name</span></code> configuration if
defined, otherwise, it will try to autodetect it. This block will consider
cross-building if Android systems (that is managed by other blocks), and not 64bits to
32bits builds in x86_64, sparc and ppc systems.</li>
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_version</span></code> conf if defined, otherwise
<code class="docutils literal notranslate"><span class="pre">os.version</span></code> subsetting (host) when defined</li>
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_processor</span></code> conf if defined, otherwise
<code class="docutils literal notranslate"><span class="pre">arch</span></code> setting (host) if defined</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cmake.html" class="btn btn-neutral float-right" title="CMake" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cmakedeps.html" class="btn btn-neutral" title="CMakeDeps" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2022, JFrog.
      Last updated on Nov 11, 2022.
      <span><a href="#" class="ot-sdk-show-settings">Cookies Settings</a></span>
    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <!--<span class="fa fa-pencil-square-o"> Other versions:</span> -->
      Version: 1.49
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          
            <dd><a href="/en/1.54/index.html">1.54</a></dd>
          
        
          
            <dd><a href="/en/1.53/index.html">1.53</a></dd>
          
        
          
            <dd><a href="/en/1.52/index.html">1.52</a></dd>
          
        
          
            <dd><a href="/en/1.51/index.html">1.51</a></dd>
          
        
          
            <dd><a href="/en/1.50/index.html">1.50</a></dd>
          
        
          
            <dd><a href="/en/1.49/index.html">1.49</a></dd>
          
        
          
            <dd><a href="/en/1.48/index.html">1.48</a></dd>
          
        
          
            <dd><a href="/en/1.47/index.html">1.47</a></dd>
          
        
          
            <dd><a href="/en/1.46/index.html">1.46</a></dd>
          
        
          
            <dd><a href="/en/1.45/index.html">1.45</a></dd>
          
        
          
            <dd><a href="/en/1.44/index.html">1.44</a></dd>
          
        
          
            <dd><a href="/en/1.43/index.html">1.43</a></dd>
          
        
          
            <dd><a href="/en/1.42/index.html">1.42</a></dd>
          
        
          
            <dd><a href="/en/1.41/index.html">1.41</a></dd>
          
        
          
            <dd><a href="/en/1.40/index.html">1.40</a></dd>
          
        
          
            <dd><a href="/en/1.39/index.html">1.39</a></dd>
          
        
          
            <dd><a href="/en/1.38/index.html">1.38</a></dd>
          
        
          
            <dd><a href="/en/1.37/index.html">1.37</a></dd>
          
        
          
            <dd><a href="/en/1.36/index.html">1.36</a></dd>
          
        
          
            <dd><a href="/en/1.35/index.html">1.35</a></dd>
          
        
          
            <dd><a href="/en/1.34/index.html">1.34</a></dd>
          
        
          
            <dd><a href="/en/1.33/index.html">1.33</a></dd>
          
        
          
            <dd><a href="/en/1.32/index.html">1.32</a></dd>
          
        
          
            <dd><a href="/en/1.31/index.html">1.31</a></dd>
          
        
          
            <dd><a href="/en/1.30/index.html">1.30</a></dd>
          
        
          
            <dd><a href="/en/1.29/index.html">1.29</a></dd>
          
        
          
            <dd><a href="/en/1.28/index.html">1.28</a></dd>
          
        
          
            <dd><a href="/en/1.27/index.html">1.27</a></dd>
          
        
          
            <dd><a href="/en/1.26/index.html">1.26</a></dd>
          
        
          
            <dd><a href="/en/1.25/index.html">1.25</a></dd>
          
        
          
            <dd><a href="/en/1.24/index.html">1.24</a></dd>
          
        
          
            <dd><a href="/en/1.23/index.html">1.23</a></dd>
          
        
          
            <dd><a href="/en/1.22/index.html">1.22</a></dd>
          
        
          
            <dd><a href="/en/1.21/index.html">1.21</a></dd>
          
        
          
            <dd><a href="/en/1.20/index.html">1.20</a></dd>
          
        
          
            <dd><a href="/en/1.19/index.html">1.19</a></dd>
          
        
          
            <dd><a href="/en/1.18/index.html">1.18</a></dd>
          
        
          
            <dd><a href="/en/1.17/index.html">1.17</a></dd>
          
        
          
            <dd><a href="/en/1.16/index.html">1.16</a></dd>
          
        
          
            <dd><a href="/en/1.15/index.html">1.15</a></dd>
          
        
          
            <dd><a href="/en/1.14/index.html">1.14</a></dd>
          
        
          
            <dd><a href="/en/1.13/index.html">1.13</a></dd>
          
        
          
            <dd><a href="/en/1.12/index.html">1.12</a></dd>
          
        
          
            <dd><a href="/en/1.11/index.html">1.11</a></dd>
          
        
          
            <dd><a href="/en/1.10/index.html">1.10</a></dd>
          
        
          
            <dd><a href="/en/1.9/index.html">1.9</a></dd>
          
        
          
            <dd><a href="/en/1.8/index.html">1.8</a></dd>
          
        
          
            <dd><a href="/en/1.7/index.html">1.7</a></dd>
          
        
          
            <dd><a href="/en/1.6/index.html">1.6</a></dd>
          
        
          
            <dd><a href="/en/1.5/index.html">1.5</a></dd>
          
        
          
            <dd><a href="/en/1.4/index.html">1.4</a></dd>
          
        
          
            <dd><a href="/en/1.3/index.html">1.3</a></dd>
          
        
          
            <dd><a href="/en/2.0/index.html">2.0</a></dd>
          
        
          
            <dd><a href="/en/latest/index.html">latest</a></dd>
          
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/en/1.49/conan.pdf">PDF</a></dd>
        
      </dl>
    </div>
  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.49.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  <!-- <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
  <script src="../../../../_static/js/modernizr.min.js"></script>
  <script src="../../../../_static/js/search.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
-->
  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


  <script>
    // initSearch("1.49");
  </script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>